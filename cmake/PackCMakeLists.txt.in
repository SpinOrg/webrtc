cmake_minimum_required(VERSION 3.14)

project(webrtc NONE)

include(GNUInstallDirs)

add_library(${PROJECT_NAME} INTERFACE)

file(GLOB WEBRTC_LIBRARIES "lib/*")
target_link_libraries(${PROJECT_NAME} INTERFACE ${WEBRTC_LIBRARIES})

target_include_directories(${PROJECT_NAME} INTERFACE $<INSTALL_INTERFACE:${CMAKE_INSTALL_INCLUDEDIR}>)
target_include_directories(${PROJECT_NAME} INTERFACE $<INSTALL_INTERFACE:${CMAKE_INSTALL_INCLUDEDIR}/webrtc>)
target_include_directories(${PROJECT_NAME} INTERFACE $<INSTALL_INTERFACE:${CMAKE_INSTALL_INCLUDEDIR}/webrtc/third_party/abseil-cpp>)
target_include_directories(${PROJECT_NAME} INTERFACE $<INSTALL_INTERFACE:${CMAKE_INSTALL_INCLUDEDIR}/webrtc/third_party/libyuv/include>)

if(WIN32)
    target_compile_definitions(${PROJECT_NAME} INTERFACE WEBRTC_WIN=1)
    target_link_libraries(${PROJECT_NAME} INTERFACE Winmm.lib Secur32.lib Msdmo.lib Wmcodecdspuuid.lib Dmoguids.lib)
elseif(APPLE)
    target_compile_definitions(${PROJECT_NAME} INTERFACE WEBRTC_MAC=1)
else()
    target_compile_definitions(${PROJECT_NAME} INTERFACE WEBRTC_LINUX=1)
endif()

install(TARGETS ${PROJECT_NAME} EXPORT ${PROJECT_NAME}-config INCLUDES DESTINATION )
install(DIRECTORY include/webrtc DESTINATION ${CMAKE_INSTALL_INCLUDEDIR})
install(EXPORT ${PROJECT_NAME}-config DESTINATION cmake)
